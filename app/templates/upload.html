<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Upload Video</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <style>
      main { max-width: 960px; margin: 2rem auto; }
      .flash { color: #b00020; }
      #loader { position: fixed; inset: 0; background: rgba(255,255,255,0.85); display: none; align-items: center; justify-content: center; gap: 1rem; z-index: 9999; }
      .spinner { width: 2rem; height: 2rem; border: 3px solid #ddd; border-top-color: #0a84ff; border-radius: 50%; animation: spin 1s linear infinite; }
      @keyframes spin { to { transform: rotate(360deg); } }
    </style>
  </head>
  <body>
    <main>
      <h2 style="text-align:center;">Upload a Video</h2>
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      <ul>
        {% for category, message in messages %}
        <li class="flash">{{ message }}</li>
        {% endfor %}
      </ul>
      {% endif %}
      {% endwith %}

      <form action="{{ url_for('ui.upload') }}" method="post" enctype="multipart/form-data">
        <label>
          Trip ID
          <input type="text" name="tripId" placeholder="e.g., TRIP-001" required />
        </label>
        <label>
          Select video (MP4/MOV/MKV/AVI)
          <input type="file" name="cvvrFile" accept="video/*" required />
        </label>
        <div style="display:flex; gap:0.5rem;">
          <button type="button" class="secondary" onclick="window.location='{{ url_for('ui.index') }}'">Back</button>
          <button type="submit">Process</button>
        </div>
      </form>
    </main>
    <div id="loader" aria-live="polite" aria-busy="true" role="status">
      <div class="spinner" aria-hidden="true"></div>
      <strong>Uploading...</strong>
    </div>
    <script>
      (function() {
        const form = document.querySelector('form');
        const loader = document.getElementById('loader');
        if (form && loader) {
          form.addEventListener('submit', function() {
            loader.style.display = 'flex';
          });
        }
      })();
    </script>
  </body>
  </html>


